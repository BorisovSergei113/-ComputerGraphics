<HTML>
 <BODY>
 	<canvas id='lab03' width='500' height="500" style="border:1px solid"> </canvas>
 		<script>
 			var canvas = document.getElementById('lab03');
 			var ctx = canvas.getContext('2d');
            var x0 = 0;
            var y0 = 0;
            var x1 = 0;
            var y1 = 0;
            var dx, dy, sx, sy, err;
            var flag = 0;

  document.addEventListener("click", function(event){
  if(event.which == 1){
    if(flag == 0){
      x0 = event.offsetX;
      y0 = event.offsetY;
      flag = 1;
    }
    else if (flag == 1) {
      x1 = event.offsetX;
      y1 = event.offsetY;
      flag = 0;
      console.log(x0,y0,x1,y1);
       dx = Math.abs(x1 - x0); // проекция отрезкаа на ось ОХ
       dy = Math.abs(y1 - y0); //проекция отрезкаа на ось ОY
       sx = (x0 < x1) ? 1 : -1; //направление отрисовки отрезка для оси ОХ
       sy = (y0 < y1) ? 1 : -1; // //направление отрисовки отрезка для оси ОY
       err = dx - dy; //ошибка

       // dx = -1|dx = 1
       // dy = -1|dy = -1
       // _______|______
       // dx = -1|dx = 1
       // dy = 1 |dy = 1

   while(!((x0 === x1) && (y0 === y1))) {
      ctx.fillRect(x0, y0, 1, 1);
      var e2 = 2*err; // *2 для целочисленных вычислений
      if (e2 > -dy) { err -= dy; x0  += sx; }
      if (e2 < dx) { err += dx; y0  += sy; }
   }
}
    }
  });
  </script>
 </BODY>
</HTML>
